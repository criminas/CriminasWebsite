---
import Layout from "../layouts/Layout.astro";
---

<Layout
    title="Contact Criminas — Get In Touch"
    description="Have questions, want to contribute, or need support? Contact the Criminas team via , email, or our contact form. We'd love to hear from you."
    keywords="contact Criminas, Criminas support, Criminas email, open source community, get in touch, Criminas "
    activePage="contact"
    ogType="website"
>
    <!-- PAGE HERO -->
    <section class="page-hero">
        <div class="hero-glow glow-1"></div>
        <div class="hero-glow glow-2"></div>
        <div class="page-hero-content fade-up">
            <h1>Get in <span class="highlight">Touch</span></h1>
            <p>
                Need support, want to contribute, or just want to say hello?
                We'd love to hear from you.
            </p>
        </div>
    </section>

    <!-- CONTACT SECTION -->
    <section class="section contact-section">
        <div class="section-container">
            <div class="contact-grid">
                <div class="contact-info fade-up">
                    <h2 class="section-title">Reach Out</h2>
                    <p class="section-desc">
                        Choose the channel that works best for you. For general
                        inquiries, use the form — for quick conversations, jump
                        inquiries, use the form below.
                    </p>
                    <div class="contact-channels">
                        <a
                            href="mailto:hello@criminas.org"
                            class="contact-channel"
                        >
                            <div class="channel-icon email">
                                <svg viewBox="0 0 24 24"
                                    ><path
                                        d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"
                                    ></path></svg
                                >
                            </div>
                            <div class="channel-text">
                                <h4>Email</h4>
                                <p>hello@criminas.org</p>
                            </div>
                        </a>
                        <a
                            href="https://github.com"
                            target="_blank"
                            rel="noopener"
                            class="contact-channel"
                        >
                            <div class="channel-icon github">
                                <svg viewBox="0 0 24 24"
                                    ><path
                                        d="M12 0C5.374 0 0 5.373 0 12c0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23A11.509 11.509 0 0112 5.803c1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576C20.566 21.797 24 17.3 24 12c0-6.627-5.373-12-12-12z"
                                    ></path></svg
                                >
                            </div>
                            <div class="channel-text">
                                <h4>GitHub</h4>
                                <p>Browse our repositories</p>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="contact-form-card fade-up">
                    <form id="contactForm">
                        <div class="form-group">
                            <label for="name">Name</label>
                            <input
                                type="text"
                                id="name"
                                name="name"
                                placeholder="Your name"
                                required
                            />
                        </div>
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input
                                type="email"
                                id="email"
                                name="email"
                                placeholder="you@example.com"
                                required
                            />
                        </div>
                        <div class="form-group">
                            <label for="subject">Subject</label>
                            <input
                                type="text"
                                id="subject"
                                name="subject"
                                placeholder="What's this about?"
                            />
                        </div>
                        <div class="form-group">
                            <label for="message">Message</label>
                            <textarea
                                id="message"
                                name="message"
                                placeholder="Tell us what's on your mind..."
                                required></textarea>
                        </div>
                        <button type="submit" class="form-submit"
                            >Send Message</button
                        >
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- FAQ SECTION -->
    <section class="content-block alt">
        <div class="content-container">
            <h2 class="section-title fade-up" style="text-align: center;">
                Frequently Asked Questions
            </h2>
            <p
                class="section-desc fade-up"
                style="text-align: center; margin: 0 auto 3rem;"
            >
                Quick answers to common questions.
            </p>

            <div class="values-grid" style="max-width: 900px; margin: 0 auto;">
                <div class="value-card fade-up">
                    <h3>How can I contribute?</h3>
                    <p>
                        All our projects are on GitHub. Fork a repo, submit a
                        PR, report bugs, or help with documentation — every
                        contribution matters.
                    </p>
                </div>
                <div class="value-card fade-up">
                    <h3>Is everything really free?</h3>
                    <p>
                        Yes! All our software is 100% free and open source. We
                        believe in removing barriers to access great technology.
                    </p>
                </div>
                <div class="value-card fade-up">
                    <h3>Can I use Criminas projects commercially?</h3>
                    <p>
                        Absolutely. Our projects use permissive open source
                        licenses. Check each project's repository for specific
                        licensing details.
                    </p>
                </div>
                <div class="value-card fade-up">
                    <h3>How do I report a security issue?</h3>
                    <p>
                        For security vulnerabilities, please email us directly
                        at security@criminas.org. We take security seriously and
                        will respond promptly.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Form Handling Script -->
    <script>
        import { api } from "../../convex/_generated/api";

        function waitForConvex(): Promise<any> {
            return new Promise((resolve) => {
                const check = () => {
                    const convex = (window as any).__convex;
                    if (convex) {
                        resolve(convex);
                    } else {
                        setTimeout(check, 50);
                    }
                };
                check();
            });
        }

        const form = document.getElementById("contactForm") as HTMLFormElement;
        const btn = form?.querySelector(".form-submit") as HTMLButtonElement;

        form?.addEventListener("submit", async (e) => {
            e.preventDefault();
            
            const formData = new FormData(form);
            const name = formData.get('name') as string;
            const email = formData.get('email') as string;
            const subject = formData.get('subject') as string;
            const message = formData.get('message') as string;

            if (!name || !email || !message) {
                return;
            }

            btn.disabled = true;
            btn.textContent = "Sending...";

            try {
                const convex = await waitForConvex();
                
                await convex.mutation(api.contact.submit, {
                    name,
                    email,
                    subject: subject || undefined,
                    message,
                });

                btn.textContent = "Message Sent! ✓";
                btn.style.background = "linear-gradient(135deg, #059669, #047857)";
                form.reset();

                setTimeout(() => {
                    btn.textContent = "Send Message";
                    btn.style.background = "";
                    btn.disabled = false;
                }, 3000);
            } catch (error) {
                console.error("Error submitting contact form:", error);
                btn.textContent = "Error - Try Again";
                btn.style.background = "linear-gradient(135deg, #dc2626, #b91c1c)";
                btn.disabled = false;

                setTimeout(() => {
                    btn.textContent = "Send Message";
                    btn.style.background = "";
                }, 3000);
            }
        });
    </script>

    <!-- Structured Data for Contact Page -->
    <script
        type="application/ld+json"
        set:html={JSON.stringify({
            "@context": "https://schema.org",
            "@type": "ContactPage",
            name: "Contact Criminas",
            description: "Get in touch with the Criminas team.",
            mainEntity: {
                "@type": "Organization",
                name: "Criminas",
                email: "hello@criminas.org",
                contactPoint: [
                    {
                        "@type": "ContactPoint",
                        email: "hello@criminas.org",
                        contactType: "customer support",
                    },
                    {
                        "@type": "ContactPoint",
                        email: "security@criminas.org",
                        contactType: "security",
                    },
                ],
            },
        })}
    />
</Layout>
